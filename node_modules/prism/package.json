{
  "name": "prism",
  "description": "Prism Realtime Server",
  "version": "0.0.1",
  "author": {
    "name": "Owen Barnes",
    "email": "owen@socketstream.org"
  },
  "engines": {
    "node": ">= 0.8.0"
  },
  "dependencies": {
    "connect": "2.2.2",
    "realtime-service": "~0.0.1"
  },
  "devDependencies": {
    "mocha": "1.8.x",
    "should": "1.2.x",
    "async": "~0.2.6",
    "colors": "~0.6.0-1",
    "rtt-mock": "0.0.x"
  },
  "scripts": {
    "benchmarks": "node benchmarks/run.js",
    "build-docs": "echo \"# Prism Server API\n\" > API.md; dox --api < index.js >> API.md"
  },
  "readme": "# Prism\n\n**Warning: This is alpha software. Feedback encouraged!**\n\nPrism is a fast, modular realtime (WebSocket) server for Node.js. Use it to power dashboards, games, and other realtime apps.\n\nAll functionality (RPC, PubSub, model syncing, etc) is provided by [Realtime Services](https://github.com/socketstream/realtime-service) - a new way to write realtime functionality and share it on `npm` without any vendor lock-in. Connect to a Prism server from the browser (or remote Node process) using [prism-client](https://github.com/socketstream/prism-client). \n\nNote: Prism is **just** a standalone realtime server, nothing else.  \nSocketStream 0.4 uses Prism to offer a fully integrated developer experience.\n\n\n## Example\n\n```js\nvar prism = require('prism');\nvar rtt = require('rtt-engineio')();\n\nvar server = prism({port: 3001, transport: rtt});\n\n// Add a Realtime Service called \"rpc\"\nserver.service('rpc', require('rts-rpc')());\n\nserver.start();\n```\n\n[View more examples](examples)\n\n## Features\n\n* designed for speed and scalability (see benchmarks below)\n* no core functionality - everything is provided by modular [Realtime Services](https://github.com/socketstream/realtime-service)\n* use native WebSockets, Engine.IO, SockJS, or any other [Realtime Transport](https://github.com/socketstream/realtime-transport)\n* the [client](https://github.com/socketstream/prism-client) runs in the browser or a remote Node process\n* share sessions between Prism and [Express.js](http://expressjs.com) (thanks to Connect Session Store)\n* swap to Connect Redis Store (or similar) when you want to scale out\n* generates a custom client module containing all the code you need for the browser\n* prevent DDOS attacks and drop malicious messages with Connect-style middleware\n* super-efficient protocol to reduce bytes over the wire (doesn't force JSON)\n* optionally sends errors back to the client for easy debugging\n* shared event bus so your application code can react to client disconnects\n* ultra-light client-side code (for sending to browser)\n\n\n## API\n\n[View API documentation](API.md) (generated from source code)\n\n\n## Truly Modular\n\nPrism uses [Realtime Services](https://github.com/socketstream/realtime-service), a new way to provide your app with PubSub, RPC, Realtime Model functionality and more without any vendor lock-in. Realtime Services can be easily written, tested and shared on `npm`.\n\nCombine multiple Realtime Services together to create the exact functionality your app needs. Prism automatically handles the message multiplexing for you using minimal bytes and CPU.\n\n\n## Connecting from the browser\n\nOnce you've added your transport and services, Prism can (optionally) build a custom client module for you:\n\n```js\nvar client = server.buildClient({});\nfs.writeFileSync('client.js', client, 'utf8');\n```\n\nThis module contains all the client-side code you need, based upon your choice of transport and services (minus any libraries which sadly can't be wrapped as Common JS modules - see Browser Assets below).\n\nUse the `client.js` module you've just built in your application's client-side code as so:\n\n```js\nvar app = require('./client')();\napp.connect(function(err, info) {\n  console.log('Connected to the server!', info);\n  console.log('You can now call this API in your client code:', app.api);\n});\n```\n\nTake this file, [browserify](https://github.com/substack/node-browserify) it, [minimize](https://github.com/mishoo/UglifyJS2) it and host it on a CDN.\n\nSee the [examples](examples) directory or the `prism-client` Readme for more info.\n\n\n## Sessions\n\nPrism supports sessions using the Connect Session Store. This design choice was made to allow integration with Express.js and various authentication systems (such as [Passport](http://passportjs.org/) which use Connect.\n\nBy default we use the in-memory store. This is fine for development, but not in production. Switch to a scalable session store (e.g. Connect Redis) with:\n\n```js\nvar app = new Server({\n  sessionStore:   new RedisStore({port: 6379})\n});\n```\n\n## Scaling\n\nThe recommended way to scale Prism is behind a proxy such as HAProxy or Nginx (which now supports WebSockets).\n\nPrism requires the load balancer to support 'sticky sessions', ensuring subsequent connections from the same browser (identified by the `connect.sid` cookie) are routed to the same back-end server. This gives a huge performance boost as all session data can be cached in RAM (although any changes are always saved back to the Session Store).\n\nAlternatively, you're able to route all incoming requests to any back-end server you please. However, under this setup you'll have to disable in-memory session caching (with `cacheSession: false`). This will force Prism to query the Session Store on each incoming message. This will naturally be much slower, unless the Session Store is designed to be used in a distributed environment.\n\n\n## Request Middleware\n\nAs incoming requests hit the server, you are able to inspect them, drop them or transform them before they are sent on to the relevant Realtime Service for processing. For performance reasons this functionality is implemented as middleware, exactly like in Express.\n\nAvailable middleware modules:\n\n[**prism-rate-limiter**](https://github.com/socketstream/prism-rate-limiter) - limits requests per second to help protect against DOS attacks\n\nUse middleware as so:\n\n```js\nserver.use(require('prism-rate-limiter')());\n```\n\n\n## Browser Assets\n\nTransports and Services often need to send assets to the browser. For example, a service designed to work with Backbone may want to send a particular version of `backbone.js` to the client.\n\nTo obtain a list of static assets to send, call:\n\n```js\nvar assets = server.browserAssets();\n```\n\nUnless you're using SocketStream 0.4, you'll need manually transform this Array of Objects into something your build system can use. Take a look at how we've done that in the `/examples/with_express` folder.\n\nIt's worth pointing out this area of Prism may change before Version 1 is released. I'm currently evaluating Bower as a possible solution to this problem. Feedback welcome!\n\n\n## Logging\n\nPrism is silent by default. To turn on logging of each incoming request, pass `console.log`, or your own custom logging function, to the server on startup:\n\n```js\nvar app = new Server({\n  port:           3001,\n  transport:      engineio,\n  log:            console.log\n});\n```\n\n## FAQs\n\n### Why not use Transform Streams instead of Connect-style middleware?\n\nI tried this initially. Not only are they more complex to implement, in practice four transform streams are almost 10 times slower than four pieces of middleware on the stack. \n\n\n## Benchmarks\n\nInstall dev dependencies then run them with `npm run benchmarks'.\n\nOn a 2009 iMac, output is currently as follows:\n\n\n    Benchmark 1: Simple echo service\n    ✓ Requests per second: 124000\n\n    Benchmark 2: Simple echo service (with JSON)\n    ✓ Requests per second: 61000\n\n    Benchmark 3: Simple echo service (with callbacks)\n    ✓ Requests per second: 69000\n\n    Benchmark 4: Simple echo service (with sessions from cache)\n    ✓ Requests per second: 75000\n\n\nNote: While the numbers are not bad, I think we can do better.\nIf it is necessary to change the internal APIs to improve performance I\nwill do so before Version 1 is released. Contributions / thoughts appreciated.\n\n\n## License \n\nMIT\n",
  "readmeFilename": "README.md",
  "_id": "prism@0.0.1",
  "_shasum": "f81f20b3980e1aa1116e0f65c84a82b73f2c1ef2",
  "_from": "prism@",
  "_resolved": "https://registry.npmjs.org/prism/-/prism-0.0.1.tgz"
}
